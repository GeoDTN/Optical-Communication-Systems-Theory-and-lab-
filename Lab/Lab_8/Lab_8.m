%Optical Communication Systems/Components
%Lab 8

clear all;
close all;
clc;

if 1==0
%Exercise 4

iterations=1:10;

B32=[9.04733299700719E-19 6.63618583078668E-26 6.02525632250227E-20 1.99322165894313E-18 2.76425314960036E-25 8.21917937129102E-17 6.71232151713824E-17 7.28932346276788E-25 2.35349442184833E-20 2.65957488905358E-23];
Q32=[9.04733299700719E-19 6.63618583078668E-26 6.02525632250227E-20 1.99322165894313E-18 2.76425314960036E-25 8.21917937129102E-17 6.71232151713824E-17 7.28932346276788E-25 2.35349442184833E-20 2.65957488905358E-23];

B64=[5.47135457655195E-18 6.67993381581133E-20 1.83526766219992E-23 3.47409055349442E-23 3.67508251466692E-22 1.24625692337603E-25 2.23005056669292E-21 2.91404136197744E-20 5.48972978775168E-19 6.15585401164325E-20];
Q64=[8.54294530511225 9.1343117938978 9.93823302003994 9.97805395057753 9.59792807293146 10.9424756146707 9.41207301463616 9.11275877560117 8.93458223729941 9.18270688027854];

B128=[7.55722047606246E-17 1.85531717652438E-19 4.66658449820167E-18 9.28606481433731E-19 7.4096868182675E-16 7.38132231861011E-19 2.58654780716939E-18 7.37068074049063E-21 4.38099517524676E-19 1.10857679131202E-20];
Q128=[8.17585794394175 9.32795366828674 8.55516517334607 8.75507556386816 7.90492465305563 8.76127252013645 8.62052695250979 9.33804837934766 8.79476739646113 9.35582960259822];

B256=[7.21858415329136E-17 1.45137722226032E-15 2.85077443179715E-17 3.74779934524746E-18 6.67822429067293E-15 5.07059059491922E-17 6.42156129555054E-16 3.92591680622935E-15 7.18042288958305E-17 1.04691778682491E-16];
Q256=[8.35361351683498 7.96415282632551 8.42751044872382 8.75312674893264 7.8995915602423 8.31507031524982 8.00563987020798 8.03792695867704 8.36693073254302 8.42363133098911];

B512=[4.73644188371169E-14 4.0696567497021E-14 9.90878374217332E-14 4.80733904754106E-15 7.33241222709481E-14 6.90369723548432E-15 7.09856419144877E-14 1.97088016134866E-14 1.94788824179501E-14 2.12464663476567E-14];
Q512=[7.56563190057774 7.59002370304105 7.49651914753863 7.89370896874174 7.48666320773091 7.9323935369936 7.50756853572223 7.69158913688367 7.59696206741528 7.70529107576775];

B1024=[6.97382845517804E-12 3.41313737722391E-12 3.53713580957039E-12 1.72425462343536E-12 3.19675986501074E-13 2.99678862033501E-12 2.97398782817779E-12 7.78590480495708E-13 3.53359781481437E-12 1.71467872355792E-12];
Q1024=[6.99806562383849 7.07490453739671 7.06025666885275 7.10490714599789 7.36301703215174 7.10844558923205 7.10818803843332 7.26593169315093 7.10938852802682 7.23021811053097];

B2040=[6.88334574972639E-19 1.16126222994524E-17 3.10219080315742E-10 6.58485082599995E-17 1.65477471365726E-16 2.30794445779965E-16 7.94690105826243E-19 1.80145928577637E-19 6.55842334450706E-24 2.25495167593883E-11];
Q2040=[9.51395692658671 8.44784725920842 6.23701614492408 9.6286582076782 8.50044289982345 9.26409902169372 9.35940156914801 9.73498695520432 11.1408702755754 7.1038852815635];

figure;
plot(iterations,log10(B32),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
hold on;
plot(iterations,log10(B64),'-s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
hold on;
plot(iterations,log10(B128),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','g','MarkerSize',10);
hold on;
plot(iterations,log10(B256),'-s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','y','MarkerSize',10);
hold on;
plot(iterations,log10(B512),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','w','MarkerSize',10);
xlabel('n° of iterations'); ylabel('log_{10}(BER)'); grid on;
hold on;
plot(iterations,log10(B1024),'-s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','m','MarkerSize',10);
xlabel('n° of iterations'); ylabel('log_{10}(BER)'); grid on;
leg=legend('32 bit','64 bit','128 bit','256 bit','512 bit','1024 bit');
set(leg,'Fontsize',12);

figure;
%plot(iterations,log10(Q32),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
%hold on;
plot(iterations,log10(Q64),'-s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
hold on;
plot(iterations,log10(Q128),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','g','MarkerSize',10);
hold on;
plot(iterations,log10(Q256),'-s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','y','MarkerSize',10);
hold on;
plot(iterations,log10(Q512),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','w','MarkerSize',10);
xlabel('n° of iterations'); ylabel('log_{10}(BER)'); grid on;
hold on;
plot(iterations,log10(Q1024),'-s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','m','MarkerSize',10);
xlabel('n° of iterations'); ylabel('log_{10}(Q)'); grid on;
leg=legend('64 bit','128 bit','256 bit','512 bit','1024 bit');
set(leg,'Fontsize',12);

samplesize=[32 64 128 256 512 1024];
Bmax=[max(B32) max(B64) max(B128) max(B256) max(B512) max(B1024)];
Bmin=[min(B32) min(B64) min(B128) min(B256) min(B512) min(B1024)];
Qmax=[max(Q32) max(Q64) max(Q128) max(Q256) max(Q512) max(Q1024)];
Qmin=[min(Q32) min(Q64) min(Q128) min(Q256) min(Q512) min(Q1024)];

figure;
plot(samplesize,log10(Bmax),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
hold on;
plot(samplesize,log10(Bmin),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('n° of samples'); ylabel('log_{10}(BER)');
leg=legend('BER max','BER min'); grid on;

figure;
plot(samplesize,(Qmax),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
hold on;
plot(samplesize,(Qmin),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('n° of samples'); ylabel('Q');
leg=legend('Q max','Q min'); grid on;

Bmax=[8.21917937129102E-17 5.47135457655195E-18 7.4096868182675E-16 6.67822429067293E-15 9.90878374217332E-14 7.78590480495708E-13 4.31438794231871E-13 1.58042294200343E-14];% 3.10219080315742E-10];
Bmin=[6.63618583078668E-26 1.24625692337603E-25 7.37068074049063E-21 3.74779934524746E-18 4.80733904754106E-15 3.19675986501074E-13 2.83201812961264E-14 9.48938029056076E-21];% 6.55842334450706E-24];
Qmax=[10.7575908142927 10.9424756146707 9.35582960259822 8.75312674893264 7.9323935369936 7.36301703215174 7.74703360664816 9.35913102001387];% 11.1408702755754];
Qmin=[8.31473118580204 8.54294530511225 7.90492465305563 7.8995915602423 7.48666320773091 6.99806562383849 7.28591604747654 7.62816224054296];% 6.23701614492408];

DB=Bmax-Bmin;
DQ=Qmax-Qmin;

figure;
plot(samplesize,log10(DB),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Sample size'); ylabel('log_{10}(BER deviation)'); grid on;
hold on;

figure;
plot(samplesize,DQ,'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Sample size'); ylabel('Q deviation'); grid on;


%Exercise 5

BER=[2.10194419106094E-22 8.09481975084956E-16 4.22940670833164E-11 7.74092497652527E-08 1.24321403396283E-05 0.000369667678262769 0.00353186819500985 0.0159185264916354 0.0438102367188169 0.0872370669129023];
Pin=[-29.2272645349786 -30.2272645349786 -31.2272645349772 -32.2272645349788 -33.227264534977 -34.2272645349797 -35.227264534978 -36.2272645349765 -37.2272645349769 -38.2272645349795];
attloss=26:35;

figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;

BER2=[0.458284757449092 1.14146220978794E-05 5.42814654811879E-16 3.85512843795256E-29 1.84496968822296E-42  1.79489236941876E-54];
Pin=-29.2272645349786;
responsivity=[0 0.4 0.8 1.2 1.6 2];

figure;
plot(responsivity,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Responsivity [A/W]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;

%Exercise 6

Pin=[-28.9098854158954 -29.9098854158955 -30.9098854158954 -31.9098854158955 -32.9098854158954 -33.9098854158955];
BER=[1.79544320646505E-22 7.90881766894532E-16 4.37921373077044E-11 8.14677465312989E-08 1.30508277249143E-05 0.00038462940334914];
attloss=16:21;

%back-to-back
BER2=[2.10194419106094E-22 8.09481975084956E-16 4.22940670833164E-11 7.74092497652527E-08 1.24321403396283E-05 0.000369667678262769 0.00353186819500985 0.0159185264916354 0.0438102367188169 0.0872370669129023];
Pin2=[-29.2272645349786 -30.2272645349786 -31.2272645349772 -32.2272645349788 -33.227264534977 -34.2272645349797 -35.227264534978 -36.2272645349765 -37.2272645349769 -38.2272645349795];
attloss=26:35;

figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;

leg=legend('50 Km fiber','back-to-back measurement');
set(leg,'Fontsize',12);

length=[5e+4 10e+4 15e+4 20e+4]; %m
Pin=[-33.9098854158955 -43.9098854158954 -53.9098854158953 -63.9098854158952];
BER=[0.00038462940334914 0.368313543934902 0.462376217467864 0.46216307423867];

figure;
plot(length,Pin,'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Length [m]'); ylabel('P_{in}'); grid on;
hold on;

%with extinction ratio=10 dB
Pin=[-28.9278074940006 -29.9278074940005 -30.9278074940006 -31.9278074940006 -32.9278074940005 -33.9278074940006];
BER=[9.54845851280804E-16 3.53127164743908E-11 6.01884774613603E-08 9.94665500742463E-06 0.000311555915246865 0.00312268015212516];
attloss=16:21;

%30 dB
Pin2=[-28.9098854158954 -29.9098854158955 -30.9098854158954 -31.9098854158955 -32.9098854158954 -33.9098854158955];
BER2=[1.79544320646505E-22 7.90881766894532E-16 4.37921373077044E-11 8.14677465312989E-08 1.30508277249143E-05 0.00038462940334914];

figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;

leg=legend('Extinction ratio = 10 dB','Extinction ratio = 30 dB');
set(leg,'Fontsize',12);

%Exercise 7

%Length: 200 Km
%Gain: 20 dB

%Back to back
Pin=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER=[8.55081635306576E-111 1.35492033866817E-100 7.73539294137099E-88 3.10082310964036E-73 4.11136260054132E-58 5.47681174309851E-44 5.24196692018723E-32 1.21479160984835E-22 8.98141830611895E-16 5.82972882302727E-11 1.08619173292251E-07 1.62727412280468E-05 0.000447601092936518 0.00403731585290135 0.01746533499222 0.0467132145782398];

figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;

%Optically amplified link
Pin2=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER2=[2.06782141923303E-10 3.02583409836266E-10 5.20290095543721E-10 1.12168312791095E-09 3.22800423843436E-09 1.30195742049809E-08 7.42922702935401E-08 5.6826490677969E-07 5.14971889194777E-06 4.66634799162122E-05 0.000357205016108861 0.00204771526850511 0.0083621456725315 0.0246247262895447 0.0549111416040921 0.0984454408695646];

figure;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;

%power penalty
figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
leg=legend('Optically amplified link','Back-to-back measurement');
set(leg,'Fontsize',12);

%Diminish the length: 190 Km
%Back to back
Pin=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER=[8.55081635306576E-111 1.35492033866817E-100 7.73539294137099E-88 3.10082310964036E-73 4.11136260054132E-58 5.47681174309851E-44 5.24196692018723E-32 1.21479160984835E-22 8.98141830611895E-16 5.82972882302727E-11 1.08619173292251E-07 1.62727412280468E-05 0.000447601092936518 0.00403731585290135 0.01746533499222 0.0467132145782398];

%Optically amplified link
Pin2=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER2=[2.17352831149447E-15 3.19108685879445E-15 5.59297618233282E-15 1.26039716192175E-14 4.00262254724011E-14 1.97601620817719E-13 1.64108295060449E-12 2.3368787775096E-11 5.13167515295095E-10 1.49248084452217E-08 4.40899502456447E-07 1.01072844216226E-05 0.000147891424675128 0.0012715590111501 0.00654190959822885 0.0217746011721723];

%power penalty
figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
leg=legend('Optically amplified link','Back-to-back measurement');
set(leg,'Fontsize',12);

%Diminish the length: 100 Km
%Back to back
Pin=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER=[8.55081635306576E-111 1.35492033866817E-100 7.73539294137099E-88 3.10082310964036E-73 4.11136260054132E-58 5.47681174309851E-44 5.24196692018723E-32 1.21479160984835E-22 8.98141830611895E-16 5.82972882302727E-11 1.08619173292251E-07 1.62727412280468E-05 0.000447601092936518 0.00403731585290135 0.01746533499222 0.0467132145782398];

%Optically amplified link
Pin2=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER2=[2.45655046570323E-100 2.4843547896396E-100 2.52772919444959E-100 2.5937571407417E-100 2.69339994390873E-100 2.84431383655464E-100 3.07638356989681E-100 3.44339976152383E-100 4.04992949387056E-100 5.12007160500171E-100 7.19832903953727E-100 1.18449222496644E-99 2.46442403002076E-99 7.28400708735535E-99 3.64242132677334E-98 3.99242209025205E-97];

%power penalty
figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
leg=legend('Optically amplified link','Back-to-back measurement');
set(leg,'Fontsize',12);

%Diminish the length: 180 Km
%Back to back
Pin=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER=[8.55081635306576E-111 1.35492033866817E-100 7.73539294137099E-88 3.10082310964036E-73 4.11136260054132E-58 5.47681174309851E-44 5.24196692018723E-32 1.21479160984835E-22 8.98141830611895E-16 5.82972882302727E-11 1.08619173292251E-07 1.62727412280468E-05 0.000447601092936518 0.00403731585290135 0.01746533499222 0.0467132145782398];

%Optically amplified link
Pin2=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER2=[5.23854155736574E-22 7.37165535439921E-22 1.21871479320645E-21 2.55206831238128E-21 7.50527317160683E-21 3.53665675856622E-20 3.09981382199204E-19 5.77644679588906E-18 2.4318926863097E-16 2.13717039950032E-14 3.0385693110091E-12 4.614032773638E-10 5.00228382908587E-08 2.87681881193516E-06 7.51707819288418E-05 0.000899933809492579];

%power penalty
figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
leg=legend('Optically amplified link','Back-to-back measurement');
set(leg,'Fontsize',12);

%Diminish the length: 160 Km
%Back to back
Pin=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197];
BER=[8.55081635306576E-111 1.35492033866817E-100 7.73539294137099E-88 3.10082310964036E-73 4.11136260054132E-58 5.47681174309851E-44 5.24196692018723E-32 1.21479160984835E-22 8.98141830611895E-16 5.82972882302727E-11 1.08619173292251E-07 1.62727412280468E-05 0.000447601092936518 0.00403731585290135 0.01746533499222];

%Optically amplified link
Pin2=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197];
BER2=[3.09836884853862E-40 3.83853246587355E-40 5.24015915517134E-40 8.27111806528103E-40 1.62216314439043E-39 4.3959457485681E-39 1.91732814712227E-38 1.66001351663821E-37 3.72861903067856E-36 2.93291879726436E-34 1.0468594474597E-31 1.85360328527494E-28 1.29844354299631E-24 1.97170216131055E-20 2.76394737597075E-16];

%power penalty
figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
leg=legend('Optically amplified link','Back-to-back measurement');
set(leg,'Fontsize',12);

%Diminish the length: 50 Km
%Back to back
Pin=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197];
BER=[8.55081635306576E-111 1.35492033866817E-100 7.73539294137099E-88 3.10082310964036E-73 4.11136260054132E-58 5.47681174309851E-44 5.24196692018723E-32 1.21479160984835E-22 8.98141830611895E-16 5.82972882302727E-11 1.08619173292251E-07 1.62727412280468E-05 0.000447601092936518 0.00403731585290135 0.01746533499222];

%Optically amplified link
Pin2=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197];
BER2=[2.06862467813235E-117 2.05796205856395E-117 2.04695305201899E-117 2.03579363394774E-117 2.02476794576997E-117 2.01427932314138E-117 2.00489331754048E-117 1.99739856972271E-117 1.99289504031451E-117 1.99292548610903E-117 1.9996775906916E-117 2.01630569095755E-117 2.04746297250048E-117 2.1002206645368E-117 2.18573575575768E-117];

%power penalty
figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
leg=legend('Optically amplified link','Back-to-back measurement');
set(leg,'Fontsize',12);

%Diminish the gain: 10 dB
%Back to back
Pin=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER=[8.55081635306576E-111 1.35492033866817E-100 7.73539294137099E-88 3.10082310964036E-73 4.11136260054132E-58 5.47681174309851E-44 5.24196692018723E-32 1.21479160984835E-22 8.98141830611895E-16 5.82972882302727E-11 1.08619173292251E-07 1.62727412280468E-05 0.000447601092936518 0.00403731585290135 0.01746533499222 0.0467132145782398];

%Optically amplified link
Pin2=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER2=[0.000336112761106761 0.00197958061940098 0.00821457608075363 0.0244032379518078 0.0546640073467344 0.0982244091629134 0.149843579150131 0.203375547038688 0.253979217999304 0.298949659532144 0.337323388627445 0.369166387961889 0.395058685679178 0.415959035076964 0.432571772404641 0.445266871106181];

%power penalty
figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
leg=legend('Optically amplified link','Back-to-back measurement');
set(leg,'Fontsize',12);

%Diminish the gain: 5 dB
%Back to back
Pin=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER=[8.55081635306576E-111 1.35492033866817E-100 7.73539294137099E-88 3.10082310964036E-73 4.11136260054132E-58 5.47681174309851E-44 5.24196692018723E-32 1.21479160984835E-22 8.98141830611895E-16 5.82972882302727E-11 1.08619173292251E-07 1.62727412280468E-05 0.000447601092936518 0.00403731585290135 0.01746533499222 0.0467132145782398];

%Optically amplified link
Pin2=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER2=[0.0976935572721068 0.149430368567804 0.203080587953757 0.253777571192078 0.29881355984679 0.337230894174419 0.369103708649052 0.395014450238383 0.415927057044563 0.432549534464528 0.445250877374532 0.454663025288949 0.45542419717583 0.455621838024276 0.455783715760983 0.453887465568562];

%power penalty
figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
leg=legend('Optically amplified link','Back-to-back measurement');

%Diminish the gain: 18 dB
%Back to back
Pin=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER=[8.55081635306576E-111 1.35492033866817E-100 7.73539294137099E-88 3.10082310964036E-73 4.11136260054132E-58 5.47681174309851E-44 5.24196692018723E-32 1.21479160984835E-22 8.98141830611895E-16 5.82972882302727E-11 1.08619173292251E-07 1.62727412280468E-05 0.000447601092936518 0.00403731585290135 0.01746533499222 0.0467132145782398];

%Optically amplified link
Pin2=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER2=[5.03511809071727E-10 1.08806453325428E-09 3.14099934740307E-09 1.27176126582203E-08 7.28906530203619E-08 5.60115646938733E-07 5.09774395388006E-06 4.6358015793362E-05 0.000355804988786883 0.00204323970074507 0.00835250792088637 0.0246103019652259 0.0548950682481828 0.0984310744188654 0.150004182069626 0.203489998918344];

%power penalty
figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
leg=legend('Optically amplified link','Back-to-back measurement');


%Diminish the gain: 16 dB
%Back to back
Pin=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER=[8.55081635306576E-111 1.35492033866817E-100 7.73539294137099E-88 3.10082310964036E-73 4.11136260054132E-58 5.47681174309851E-44 5.24196692018723E-32 1.21479160984835E-22 8.98141830611895E-16 5.82972882302727E-11 1.08619173292251E-07 1.62727412280468E-05 0.000447601092936518 0.00403731585290135 0.01746533499222 0.0467132145782398];

%Optically amplified link
Pin2=[-21.8804620050209 -22.8804620050201 -23.8804620050189 -24.880462005021 -25.880462005019 -26.8804620050195 -27.8804620050198 -28.8804620050204 -29.8804620050194 -30.8804620050201 -31.8804620050189 -32.8804620050199 -33.8804620050196 -34.8804620050197 -35.8804620050197 -36.8804620050196];
BER2=[3.00743617920005E-09 1.2251857703076E-08 7.07170154389574E-08 5.47406837498183E-07 5.01626968476833E-06 4.58771651549419E-05 0.000353594499294398 0.00203616000846778 0.0083372466527876 0.0245874495748748 0.0548695973066776 0.0984083057452183 0.149986495147708 0.203477399544134 0.254048718799491 0.29899646912235];

%power penalty
figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin2,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
leg=legend('Optically amplified link','Back-to-back measurement');


%Plot the power penalties
P=[6.4 1.15 -1.8];
L=[2 1.9 1.8]*10^5;

figure;
plot(L,P,'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Length [m]'); ylabel('Power penalty [dBm]'); grid on;

P=[6.4 8.25 10];
G=[20 18 16];

figure;
plot(G,P,'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Gain [dB]'); ylabel('Power penalty [dBm]'); grid on;

%Question 4

%normal receiver
Pin=[-31.0400302690614 -37.0400302690612 -43.0400302690619 -49.0400302690607 -55.0400302690626];
BER=[8.33213780384296E-11 0.0495817918398074 0.346989425085303 0.458804264509987 0.460384262956894];

%optical preamplified receiver
Pin2=[-31.0400302690614 -37.0400302690612 -43.0400302690619 -49.0400302690607 -55.0400302690626];
BER2=[1.36105792400825E-72 5.83703471865365E-35 1.49026229085443E-11 0.00264570801554664 0.172421466178702];

figure;
plot(Pin,-log10(-log10(BER)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','r','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
hold on;
plot(Pin,-log10(-log10(BER2)),'--s','Linewidth',2,'MarkerEdgeColor','k','MarkerFaceColor','b','MarkerSize',10);
xlabel('Input power [dBm]'); ylabel('-log_{10}(-log_{10}(BER))'); grid on;
leg=legend('Normal receiver','Optically pre-amplified receiver');
end

